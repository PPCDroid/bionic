/*
 * Implementation of generic syscall routine for MIPS
 * Based on autogenerated syscall implementations
 * in bionic/libc/arch-mips/syscalls/
 *
 * It can not be used for calling syscalls
 * with more than 4 arguments not including syscall number
 */
#include <sys/linux-syscalls.h>
#include <sys/regdef.h>

    .text
    .globl syscall
    .align 2
    .ent syscall,0

syscall:
    .set noreorder

    .cpload t9
    /* Have to do a lots of moves*/
    /* because C calling convention are:*/
    /* %v0 f(%a0,%a1,%a2,%a3,stack..) */
    /* but syscall number should be put into v0*/
    /* that is we had to shift rest of the args*/
    move v0, a0
    move a0, a1
    move a1, a2
    move a2, a3
    lw   a3,16(sp)
    syscall
    .set reorder
    j ra
    nop
    .end syscall
    .size syscall,.-syscall
